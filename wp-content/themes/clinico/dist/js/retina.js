!function(){function Retina(){}function suffixReplace(match){return config.retinaImageSuffix+match}function RetinaImagePath(path,at_2x_path){if(this.path=path||"","undefined"!=typeof at_2x_path&&null!==at_2x_path)this.at_2x_path=at_2x_path,this.perform_check=!1;else{if(void 0!==document.createElement){var locationObject=document.createElement("a");locationObject.href=this.path,locationObject.pathname=locationObject.pathname.replace(regexMatch,suffixReplace),this.at_2x_path=locationObject.href}else{var parts=this.path.split("?");parts[0]=parts[0].replace(regexMatch,suffixReplace),this.at_2x_path=parts.join("?")}this.perform_check=!0}}function RetinaImage(el){this.el=el,this.path=new RetinaImagePath(this.el.getAttribute("src"),this.el.getAttribute("data-at2x"));var that=this;this.path.check_2x_variant(function(hasVariant){hasVariant&&that.swap()})}var root="undefined"==typeof exports?window:exports,config={retinaImageSuffix:"@2x",check_mime_type:!0,force_original_dimensions:!0};root.Retina=Retina,Retina.configure=function(options){null===options&&(options={});for(var prop in options)options.hasOwnProperty(prop)&&(config[prop]=options[prop])},Retina.init=function(context){null===context&&(context=root),context.addEventListener("load",function(){var i,image,images=document.getElementsByTagName("img"),imagesLength=images.length,retinaImages=[];for(i=0;imagesLength>i;i+=1)image=images[i],image.getAttributeNode("data-no-retina")||image.src&&retinaImages.push(new RetinaImage(image))})},Retina.isRetina=function(){var mediaQuery="(-webkit-min-device-pixel-ratio: 1.5), (min--moz-device-pixel-ratio: 1.5), (-o-min-device-pixel-ratio: 3/2), (min-resolution: 1.5dppx)";return root.devicePixelRatio>1?!0:!(!root.matchMedia||!root.matchMedia(mediaQuery).matches)};var regexMatch=/\.[\w\?=]+$/;root.RetinaImagePath=RetinaImagePath,RetinaImagePath.confirmed_paths=[],RetinaImagePath.prototype.is_external=function(){return!(!this.path.match(/^https?\:/i)||this.path.match("//"+document.domain))},RetinaImagePath.prototype.check_2x_variant=function(callback){var http,that=this;return this.perform_check||"undefined"==typeof this.at_2x_path||null===this.at_2x_path?this.at_2x_path in RetinaImagePath.confirmed_paths?callback(!0):this.is_external()?callback(!1):(http=new XMLHttpRequest,http.open("HEAD",this.at_2x_path),http.onreadystatechange=function(){if(4!==http.readyState)return callback(!1);if(http.status>=200&&http.status<=399){if(config.check_mime_type){var type=http.getResponseHeader("Content-Type");if(null===type||!type.match(/^image/i))return callback(!1)}return RetinaImagePath.confirmed_paths.push(that.at_2x_path),callback(!0)}return callback(!1)},http.send(),void 0):callback(!0)},root.RetinaImage=RetinaImage,RetinaImage.prototype.swap=function(path){function load(){that.el.complete?(config.force_original_dimensions&&(0==that.el.offsetWidth&&0==that.el.offsetHeight||that.el.offsetWidth!=that.el.naturalWidth?(that.el.setAttribute("width",that.el.naturalWidth),that.el.setAttribute("height",that.el.naturalHeight)):(that.el.setAttribute("width",that.el.offsetWidth),that.el.setAttribute("height",that.el.offsetHeight))),that.el.setAttribute("src",path)):setTimeout(load,5)}"undefined"==typeof path&&(path=this.path.at_2x_path);var that=this;load()},Retina.isRetina()&&Retina.init(root)}();